; BlackCat minimal-prod hardening baseline (demo/prototype).
;
; Goal: keep the demo close to a “strict mode” production posture.
; Notes:
; - Some settings (disable_functions/open_basedir/allow_url_include/phar.readonly) are PHP_INI_SYSTEM and cannot be changed at runtime.
; - The TrustKernel gates strict mode on a safe PHP posture (fail-closed).

expose_php=0
display_errors=0
display_startup_errors=0
log_errors=1

; Reduce SSRF surface: TrustKernel prefers ext-curl.
allow_url_fopen=0
allow_url_include=0

; Prevent phar write gadgets.
phar.readonly=1

; Prevent runtime extension loading.
enable_dl=0

; Restrict PHP filesystem access to known-safe roots used by the kernel stack.
open_basedir=/srv/blackcat:/etc/blackcat:/var/lib/blackcat:/tmp:/var/tmp

; Reduce command execution surface (verify your app does not require these).
disable_functions=exec,shell_exec,system,passthru,popen,proc_open,pcntl_exec

; Session hardening (best-effort defaults; may be overridden by app frameworks).
session.use_strict_mode=1
session.use_only_cookies=1
session.use_trans_sid=0
session.cookie_httponly=1
