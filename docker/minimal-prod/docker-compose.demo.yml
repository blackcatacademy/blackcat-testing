services:
  app:
    environment:
      BLACKCAT_TESTING_INSECURE_URL: "${BLACKCAT_TESTING_INSECURE_URL:-http://localhost:8089/}"
      BLACKCAT_TESTING_DEMO_WALLETS_FILE: "${BLACKCAT_TESTING_DEMO_WALLETS_FILE:-/mnt/blackcat-demo/demo.wallets.public.json}"
    volumes:
      - ../../var/demo/public:/mnt/blackcat-demo:ro

  insecure:
    build:
      context: ../../..
      dockerfile: blackcat-testing/docker/minimal-prod/insecure/Dockerfile
    environment:
      DB_DSN: "${BLACKCAT_DB_DSN:-mysql:host=db;dbname=blackcat_test;charset=utf8mb4}"
      DB_USER: "${BLACKCAT_DB_USER:-blackcat}"
      DB_PASS: "${BLACKCAT_DB_PASS:-blackcat}"
    ports:
      - "127.0.0.1:8089:8080"
    depends_on:
      db:
        condition: service_healthy
